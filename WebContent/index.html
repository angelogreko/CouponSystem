<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="couponstyle.css">
<meta charset="ISO-8859-1">
<title>The Coupons App</title>

<script type="text/javascript">
	function login(btn) {
		var formField = getFormField();
		btn.disabled = true;
		document.getElementById("statDiv").innerHTML = '<Loading>...</p>'
		sendForm(formFields);
	}

	function sendForm(formFields) {
		var AJAX = new XMLHttpRequest();
		AJAX.responseType = "json";
		AJAX.open("POST",
				'http://localhost:8080/com.angelo.coupon/LoginServlet', true);
		AJAX.setRequestHeader("Content-type",
				"application/x-www-form-urlencoded");
		AJAX.onreadystatechange = function() {
			if (AJAX.readyState == 4) {
				processResponse(AJAX.response);
			}
		};
		AJAX.send(formFields);
	}

	function getFormFields() {
		var formElements = document.getElementById('loginForm').elements;
		var paramString = '';
		alert(formElements.length);
		for (var i = 0; i < formElements.length; i++) {
			paramString += formElements[i].name + '=' + formElements[i].value
					+ '&';
		}
		return paramString;

	}

	function processResponse(jsonObj) {
		var ret = jsonObj.respCode;
		if (ret == 'ok') {
			document.getElementById("mainView").innerHTML = '<p>Welcome!</p>';
		} else {
			document.getElementById("submitBtn").disabled = false;
			document.getElementById("statDiv").innerHTML = '<p><b>Login failed!</b></p>';
		}
	}
</script>

</head>
<body>
	<table>
		<tr id="header">
			<td id="leftheader" class="Logo"><img src="Images/ACoupons.png"
				width="300" height="90" border="0"></td>
			<td id="rightheader">
				<h2 align="center" style="font-family: cursive;">You will not
					miss any great discount never ever again!</h2>
			</td>
		</tr>
		<tr id="rowmain">
			<td id="sidemenu" class="sidemenu">
				<form id="loginForm" class="login">
					<h1>Login</h1>
					<p>
						<select name="clientType" style="width: 170px;">
							<option selected disabled>Choose</option>
							<option value="admin">Admin</option>
							<option value="company">Company</option>
							<option value="customer">Customer</option>
						</select>
					</p>
					<p>
						<input type="text" name="name" value="" placeholder="Name">
					</p>
					<p>
						<input type="password" name="password" value=""
							placeholder="Password">
					</p>
					<p class="submit">
						<input id="login" type="button" value="Login"
							onclick="login(this)">
					</p>
				</form>
			</td>
			<td id="mainwindow">c</td>
		</tr>
		<tr>
			<td id="footer" colspan="2">
				<div>
					<footer class="footer" style="text-align: center;">
						<div>Coupon System Project, John Bryce, 2016 &#169 Angelo</div>
					</footer>
				</div>
			</td>
		</tr>
	</table>
</body>
</html>